import{n as u,j as k,w as y,o as d,b as t,t as o,c,a as v,h as P,u as D,i as N,e as b,f as S,F as j,s as M,g as m}from"./app-DSbO2B8p.js";import{A as $}from"./AuthenticatedLayout-C2NJg4lw.js";import{P as B}from"./Pagination-DBAlykLF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"container-fluid p-2"},E={class:"row g-4"},V={class:"col-md-3"},I={class:"card p-3 shadow-sm border-0 bg-light"},L={class:"d-flex align-items-center"},T={class:"ms-3"},Y={class:"mb-0"},R={class:"mb-0"},z={class:"col-md-3"},G={class:"card p-3 shadow-sm border-0 bg-light"},H={class:"d-flex align-items-center"},O={class:"ms-3"},q={class:"mb-0"},J={class:"col-md-3"},K={class:"card p-3 shadow-sm border-0 bg-light"},Q={class:"d-flex align-items-center"},U={class:"ms-3"},W={class:"mb-0"},X={class:"col-md-3"},Z={class:"card p-3 shadow-sm border-0 bg-light"},tt={class:"d-flex align-items-center"},st={class:"ms-3"},et={class:"mb-0"},nt={class:"col-md-12"},ot={class:"card shadow-sm border-0"},lt={class:"card-header bg-white"},it={class:"d-flex justify-content-between align-items-center"},dt={class:"mb-0"},at={key:0},rt={class:"card-body p-0"},ct={class:"table-responsive"},ut={class:"table table-hover mb-0"},bt={class:"table-light"},mt={class:"border-0"},gt={class:"badge bg-info"},ht={class:"text-muted"},yt={class:"text-success"},vt=["onClick"],xt=["onClick"],ft=["onClick"],_t={class:"card-footer bg-white"},kt={__name:"Index",props:{payrolls:Object,isAdmin:Boolean},setup(l){const i=l,x=u(()=>i.payrolls.data.filter(e=>e.status==="approved"||e.status==="paid").length),f=u(()=>i.payrolls.data.filter(e=>e.status==="pending").length),_=u(()=>{const e=new Date().getMonth(),s=new Date().getFullYear();return i.payrolls.data.filter(n=>{const r=new Date(n.start_date);return r.getMonth()===e&&r.getFullYear()===s}).length}),p=e=>{const s=i.isAdmin?`/admin/payroll/${e.id}`:`/payroll/${e.id}`;m.get(s)},w=e=>{if(!i.isAdmin){console.error("Non-admin user attempted to edit payroll");return}const s=`/admin/payroll/${e.id}/edit`;m.get(s)},A=e=>{if(!i.isAdmin){console.error("Non-admin user attempted to delete payroll");return}if(confirm("Are you sure you want to delete this payroll record?")){const s=`/admin/payroll/${e.id}`;console.log("Deleting payroll with route:",s),console.log("Current pathname:",window.location.pathname),console.log("Is admin user:",i.isAdmin),m.delete(s,{onSuccess:()=>{console.log("Payroll deleted successfully")},onError:n=>{console.error("Error deleting payroll:",n),console.error("Error details:",n)}})}},g=e=>new Date(e).toLocaleDateString(),a=e=>new Intl.NumberFormat("en-PH").format(e),C=e=>{switch(e){case"draft":return"badge bg-secondary";case"pending":return"badge bg-warning";case"approved":return"badge bg-success";case"paid":return"badge bg-primary";case"cancelled":return"badge bg-danger";default:return"badge bg-secondary"}};return(e,s)=>(d(),k($,null,{default:y(()=>[t("div",F,[t("div",E,[t("div",V,[t("div",I,[t("div",L,[s[0]||(s[0]=t("div",{class:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px"}},[t("i",{class:"bx bxs-dollar-circle"})],-1)),t("div",T,[t("h6",Y,o(l.isAdmin?"Total Payrolls":"My Payrolls"),1),t("h3",R,o(l.payrolls.total),1)])])])]),t("div",z,[t("div",G,[t("div",H,[s[2]||(s[2]=t("div",{class:"bg-success text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px"}},[t("i",{class:"bx bxs-check-circle"})],-1)),t("div",O,[s[1]||(s[1]=t("h6",{class:"mb-0"},"Approved",-1)),t("h3",q,o(x.value),1)])])])]),t("div",J,[t("div",K,[t("div",Q,[s[4]||(s[4]=t("div",{class:"bg-warning text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px"}},[t("i",{class:"bx bxs-time"})],-1)),t("div",U,[s[3]||(s[3]=t("h6",{class:"mb-0"},"Pending",-1)),t("h3",W,o(f.value),1)])])])]),t("div",X,[t("div",Z,[t("div",tt,[s[6]||(s[6]=t("div",{class:"bg-info text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px"}},[t("i",{class:"bx bxs-calendar"})],-1)),t("div",st,[s[5]||(s[5]=t("h6",{class:"mb-0"},"This Month",-1)),t("h3",et,o(_.value),1)])])])]),t("div",nt,[t("div",ot,[t("div",lt,[t("div",it,[t("h5",dt,o(l.isAdmin?"All Payroll Records":"My Payroll Records"),1),l.isAdmin?(d(),c("div",at,[v(D(N),{href:e.route("admin.payroll.create"),class:"btn btn-primary btn-sm"},{default:y(()=>s[7]||(s[7]=[t("i",{class:"bx bx-plus me-1"},null,-1),P("Create Payroll ")])),_:1},8,["href"])])):b("",!0)])]),t("div",rt,[t("div",ct,[t("table",ut,[t("thead",bt,[t("tr",null,[s[8]||(s[8]=t("th",{class:"border-0"},"Employee",-1)),s[9]||(s[9]=t("th",{class:"border-0"},"Period",-1)),s[10]||(s[10]=t("th",{class:"border-0"},"Basic Salary",-1)),s[11]||(s[11]=t("th",{class:"border-0"},"Gross Salary",-1)),s[12]||(s[12]=t("th",{class:"border-0"},"Allowances",-1)),s[13]||(s[13]=t("th",{class:"border-0"},"Deductions",-1)),s[14]||(s[14]=t("th",{class:"border-0"},"Net Salary",-1)),s[15]||(s[15]=t("th",{class:"border-0"},"Status",-1)),t("th",mt,o(l.isAdmin?"Actions":"View"),1)])]),t("tbody",null,[(d(!0),c(j,null,S(l.payrolls.data,n=>{var r;return d(),c("tr",{key:n.id},[t("td",null,o((r=n.user)==null?void 0:r.name),1),t("td",null,[t("span",gt,o(n.period_display),1),s[16]||(s[16]=t("br",null,null,-1)),t("small",ht,o(g(n.start_date))+" - "+o(g(n.end_date)),1)]),t("td",null,"₱"+o(a(n.basic_salary)),1),t("td",null,"₱"+o(a(n.gross_salary)),1),t("td",null,"₱"+o(a(n.total_allowances)),1),t("td",null,"₱"+o(a(n.total_deductions)),1),t("td",null,[t("strong",yt,"₱"+o(a(n.net_salary)),1)]),t("td",null,[t("span",{class:M(C(n.status))},o(n.status_badge_class),3)]),t("td",null,[t("button",{class:"btn btn-sm btn-outline-primary me-1",onClick:h=>p(n)},s[17]||(s[17]=[t("i",{class:"bx bx-show"},null,-1)]),8,vt),l.isAdmin?(d(),c("button",{key:0,class:"btn btn-sm btn-outline-warning me-1",onClick:h=>w(n)},s[18]||(s[18]=[t("i",{class:"bx bx-edit"},null,-1)]),8,xt)):b("",!0),l.isAdmin?(d(),c("button",{key:1,class:"btn btn-sm btn-outline-danger",onClick:h=>A(n)},s[19]||(s[19]=[t("i",{class:"bx bx-trash"},null,-1)]),8,ft)):b("",!0)])])}),128))])])])]),t("div",_t,[v(B,{paginate:l.payrolls},null,8,["paginate"])])])])])])]),_:1}))}};export{kt as default};
