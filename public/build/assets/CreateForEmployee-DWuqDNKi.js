import{T as E,n as p,A as T,j as U,w as g,o,b as e,a as q,h as c,u as l,i as A,k as S,d as m,x,c as d,f as k,F as w,t as r,e as n,l as b}from"./app-DSbO2B8p.js";import{A as j}from"./AuthenticatedLayout-C2NJg4lw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"container-fluid p-2"},N={class:"row g-4"},B={class:"col-md-12"},F={class:"card shadow-sm border-0"},O={class:"card-header bg-white"},P={class:"d-flex justify-content-between align-items-center"},I={class:"card-body"},z={class:"row"},G={class:"col-md-6"},H={class:"mb-3"},J=["value"],K={key:0,class:"text-danger small mt-1"},Q={class:"col-md-6"},W={class:"mb-3"},X=["value"],Y={key:0},Z={key:0,class:"text-danger small mt-1"},$={key:0,class:"mb-4 p-3 bg-info bg-opacity-10 rounded"},ee={class:"row"},se={class:"card border-info"},te={class:"card-body p-3"},ae={class:"small font-weight-bold"},le={class:"small mt-2"},oe={class:"text-success"},de={class:"text-muted"},re={class:"small text-muted"},ne={class:"row"},ie={class:"col-md-6"},ue={class:"mb-3"},me={key:0,class:"text-danger small mt-1"},ce={class:"col-md-6"},ve={class:"mb-3"},_e={key:0,class:"text-danger small mt-1"},pe={key:1,class:"mb-3"},be={class:"p-3 bg-light rounded"},ye={class:"badge bg-secondary"},fe={key:0,class:"ms-2 small"},he={key:0,class:"text-danger"},ge={class:"mb-3"},xe={key:0,class:"text-danger small mt-1"},ke={class:"row"},we={class:"col-md-6"},Ce={class:"mb-3"},qe={key:0,class:"text-danger small mt-1"},Ae={class:"col-md-6"},De={class:"mb-3"},Ve={key:0,class:"text-danger small mt-1"},Le={class:"d-flex justify-content-end gap-2"},Re=["disabled"],Se={__name:"CreateForEmployee",props:{employees:Array,leaveRules:Array,employeeCredits:Object},setup(y){const f=y,t=E({user_id:"",leave_type:"",start_date:"",end_date:"",details:"",status:"pending",admin_notes:""}),i=p(()=>!t.user_id||!f.employeeCredits[t.user_id]?null:f.employeeCredits[t.user_id]),v=p(()=>!i.value||!t.leave_type?null:i.value[t.leave_type]),_=p(()=>{if(!t.start_date||!t.end_date)return 0;const u=new Date(t.start_date),s=new Date(t.end_date),a=Math.abs(s-u);return Math.ceil(a/(1e3*60*60*24))+1}),C=p(()=>v.value?v.value.available_credits>=_.value:!0),D=u=>{const s=f.leaveRules.find(a=>a.leave_type===u);return s?s.display_name:u},V=()=>{t.leave_type=""},L=()=>{};T([()=>t.start_date,()=>t.end_date],()=>{});const R=()=>{if(!C.value){alert("The employee doesn't have enough credits for this request.");return}t.post(route("admin.leave.store"))};return(u,s)=>(o(),U(j,null,{default:g(()=>[e("div",M,[e("div",N,[e("div",B,[e("div",F,[e("div",O,[e("div",P,[s[8]||(s[8]=e("h5",{class:"mb-0"},"Create Leave Request for Employee",-1)),q(l(A),{href:u.route("admin.leave.index"),class:"btn btn-outline-secondary btn-sm"},{default:g(()=>s[7]||(s[7]=[e("i",{class:"bx bx-arrow-back me-1"},null,-1),c("Back to Leave Management ")])),_:1},8,["href"])])]),e("div",I,[e("form",{onSubmit:S(R,["prevent"])},[e("div",z,[e("div",G,[e("div",H,[s[10]||(s[10]=e("label",{class:"form-label"},"Employee",-1)),m(e("select",{"onUpdate:modelValue":s[0]||(s[0]=a=>l(t).user_id=a),onChange:V,class:"form-control",required:""},[s[9]||(s[9]=e("option",{value:""},"Select employee",-1)),(o(!0),d(w,null,k(y.employees,a=>(o(),d("option",{key:a.id,value:a.id},r(a.name)+" ("+r(a.email)+") ",9,J))),128))],544),[[x,l(t).user_id]]),l(t).errors.user_id?(o(),d("div",K,r(l(t).errors.user_id),1)):n("",!0)])]),e("div",Q,[e("div",W,[s[12]||(s[12]=e("label",{class:"form-label"},"Leave Type",-1)),m(e("select",{"onUpdate:modelValue":s[1]||(s[1]=a=>l(t).leave_type=a),onChange:L,class:"form-control",required:""},[s[11]||(s[11]=e("option",{value:""},"Select leave type",-1)),(o(!0),d(w,null,k(y.leaveRules,a=>(o(),d("option",{key:a.leave_type,value:a.leave_type},[c(r(a.display_name)+" ",1),i.value&&i.value[a.leave_type]?(o(),d("span",Y," ("+r(i.value[a.leave_type].available_credits)+" credits left) ",1)):n("",!0)],8,X))),128))],544),[[x,l(t).leave_type]]),l(t).errors.leave_type?(o(),d("div",Z,r(l(t).errors.leave_type),1)):n("",!0)])])]),i.value?(o(),d("div",$,[s[14]||(s[14]=e("h6",{class:"text-info mb-3"},"Available Leave Credits",-1)),e("div",ee,[(o(!0),d(w,null,k(i.value,(a,h)=>(o(),d("div",{key:h,class:"col-md-4"},[e("div",se,[e("div",te,[e("div",ae,r(D(h)),1),e("div",le,[e("span",oe,"Available: "+r(a.available_credits),1),s[13]||(s[13]=c(" / ")),e("span",de,"Total: "+r(a.total_credits),1)]),e("div",re," Used: "+r(a.used_credits),1)])])]))),128))])])):n("",!0),e("div",ne,[e("div",ie,[e("div",ue,[s[15]||(s[15]=e("label",{class:"form-label"},"Start Date",-1)),m(e("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>l(t).start_date=a),type:"date",class:"form-control",required:""},null,512),[[b,l(t).start_date]]),l(t).errors.start_date?(o(),d("div",me,r(l(t).errors.start_date),1)):n("",!0)])]),e("div",ce,[e("div",ve,[s[16]||(s[16]=e("label",{class:"form-label"},"End Date",-1)),m(e("input",{"onUpdate:modelValue":s[3]||(s[3]=a=>l(t).end_date=a),type:"date",class:"form-control",required:""},null,512),[[b,l(t).end_date]]),l(t).errors.end_date?(o(),d("div",_e,r(l(t).errors.end_date),1)):n("",!0)])])]),_.value>0?(o(),d("div",pe,[s[17]||(s[17]=e("label",{class:"form-label"},"Days Requested",-1)),e("div",be,[e("span",ye,r(_.value)+" days",1),v.value?(o(),d("span",fe,[c(" Available credits: "+r(v.value.available_credits)+" ",1),_.value>v.value.available_credits?(o(),d("span",he," ⚠️ Insufficient credits ")):n("",!0)])):n("",!0)])])):n("",!0),e("div",ge,[s[18]||(s[18]=e("label",{class:"form-label"},"Request Details",-1)),m(e("textarea",{"onUpdate:modelValue":s[4]||(s[4]=a=>l(t).details=a),rows:"4",class:"form-control",placeholder:"Please provide detailed reason for the leave request...",required:""},null,512),[[b,l(t).details]]),l(t).errors.details?(o(),d("div",xe,r(l(t).errors.details),1)):n("",!0)]),e("div",ke,[e("div",we,[e("div",Ce,[s[20]||(s[20]=e("label",{class:"form-label"},"Status",-1)),m(e("select",{"onUpdate:modelValue":s[5]||(s[5]=a=>l(t).status=a),class:"form-control",required:""},s[19]||(s[19]=[e("option",{value:"pending"},"⏳ Pending",-1),e("option",{value:"approved"},"✅ Approved",-1),e("option",{value:"rejected"},"❌ Rejected",-1)]),512),[[x,l(t).status]]),l(t).errors.status?(o(),d("div",qe,r(l(t).errors.status),1)):n("",!0)])]),e("div",Ae,[e("div",De,[s[21]||(s[21]=e("label",{class:"form-label"},"Admin Notes (Optional)",-1)),m(e("textarea",{"onUpdate:modelValue":s[6]||(s[6]=a=>l(t).admin_notes=a),rows:"2",class:"form-control",placeholder:"Add any admin notes..."},null,512),[[b,l(t).admin_notes]]),l(t).errors.admin_notes?(o(),d("div",Ve,r(l(t).errors.admin_notes),1)):n("",!0)])])]),e("div",Le,[q(l(A),{href:u.route("admin.leave.index"),class:"btn btn-secondary"},{default:g(()=>s[22]||(s[22]=[e("i",{class:"bx bx-x me-1"},null,-1),c("Cancel ")])),_:1},8,["href"]),e("button",{type:"submit",disabled:!C.value,class:"btn btn-primary"},s[23]||(s[23]=[e("i",{class:"bx bx-plus me-1"},null,-1),c("Create Leave Request ")]),8,Re)])],32)])])])])])]),_:1}))}};export{Se as default};
