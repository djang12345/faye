import{r as x,n as w,p as ee,j as se,w as te,o as n,b as e,t as l,h as r,c as d,f as A,F as D,a as le,s as I,e as u,k as h,d as m,x as S,l as R,g as oe,T as ae}from"./app-DSbO2B8p.js";import{A as ne}from"./AuthenticatedLayout-C2NJg4lw.js";import{P as de}from"./Pagination-DBAlykLF.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";const re={class:"container-fluid p-2"},ue={class:"row g-4"},ve={class:"col-md-3"},me={class:"card p-3 shadow-sm border-0 bg-light"},ce={class:"d-flex align-items-center"},pe={class:"ms-3"},be={class:"mb-0"},ye={class:"col-md-3"},_e={class:"card p-3 shadow-sm border-0 bg-light"},ge={class:"d-flex align-items-center"},fe={class:"ms-3"},xe={class:"mb-0"},we={class:"col-md-3"},ke={class:"card p-3 shadow-sm border-0 bg-light"},Ce={class:"d-flex align-items-center"},he={class:"ms-3"},Re={class:"mb-0"},Ae={class:"col-md-3"},De={class:"card p-3 shadow-sm border-0 bg-light"},Se={class:"d-flex align-items-center"},je={class:"ms-3"},qe={class:"mb-0"},Pe={class:"col-md-12"},Le={class:"card shadow-sm border-0"},Te={class:"card-body p-0"},Ve={class:"table-responsive"},Ne={class:"table table-hover mb-0"},$e={class:"text-muted small"},Me={class:"badge bg-info"},Fe={class:"small"},Ue={class:"badge bg-secondary"},Ee={class:"small text-muted"},Ie=["onClick"],Be=["onClick"],Oe=["onClick"],ze=["onClick"],Ge={class:"card-footer bg-white"},He={class:"modal-content"},Je={class:"modal-header"},Ke={key:0,class:"modal-body"},Qe={class:"row"},We={class:"col-md-6"},Xe={class:"col-md-6"},Ye={class:"badge bg-info"},Ze={class:"badge bg-secondary"},es={class:"row mt-3"},ss={class:"col-md-6"},ts={class:"col-md-6"},ls={key:0},os={key:1},as={class:"row mt-3"},ns={class:"col-12"},ds={class:"p-3 bg-light rounded"},is={key:0,class:"row mt-3"},rs={class:"col-12"},us={class:"p-3 bg-warning bg-opacity-10 rounded"},vs={class:"modal-footer"},ms={class:"modal-content"},cs={class:"modal-header"},ps={class:"modal-body"},bs={class:"mb-3"},ys={class:"mb-3"},_s={class:"modal-footer"},gs={class:"modal-content"},fs={class:"modal-header"},xs={class:"modal-body"},ws={class:"row"},ks={class:"col-md-6"},Cs={class:"mb-3"},hs=["value"],Rs={class:"col-md-6"},As={class:"mb-3"},Ds=["value"],Ss={key:0},js={key:0,class:"mb-3 p-3 bg-info bg-opacity-10 rounded"},qs={class:"row"},Ps={class:"card border-info"},Ls={class:"card-body p-2"},Ts={class:"small font-weight-bold"},Vs={class:"small"},Ns={class:"text-success"},$s={class:"text-muted"},Ms={class:"small text-muted"},Fs={class:"row"},Us={class:"col-md-6"},Es={class:"mb-3"},Is={class:"col-md-6"},Bs={class:"mb-3"},Os={key:1,class:"mb-3"},zs={class:"p-2 bg-light rounded"},Gs={class:"badge bg-secondary"},Hs={key:0,class:"ms-2 small"},Js={key:0,class:"text-danger"},Ks={class:"mb-3"},Qs={class:"row"},Ws={class:"col-md-6"},Xs={class:"mb-3"},Ys={class:"col-md-6"},Zs={class:"mb-3"},et={class:"modal-footer"},st={__name:"AdminIndex",props:{leaveRequests:Object,employees:Array,leaveRules:Array,employeeCredits:Object},setup(y){const _=y,i=x(null),p=x(!1),c=x(!1),g=x(!1),v=x({status:"",admin_notes:""}),o=x({user_id:"",leave_type:"",start_date:"",end_date:"",details:"",status:"pending",admin_notes:""}),B=w(()=>_.leaveRequests.data.filter(a=>a.status==="pending").length),O=w(()=>_.leaveRequests.data.filter(a=>a.status==="approved").length),z=w(()=>_.leaveRequests.data.filter(a=>a.status==="rejected").length),b=w(()=>!o.value.user_id||!_.employeeCredits[o.value.user_id]?null:_.employeeCredits[o.value.user_id]),j=w(()=>!b.value||!o.value.leave_type?null:b.value[o.value.leave_type]),q=w(()=>{if(!o.value.start_date||!o.value.end_date)return 0;const a=new Date(o.value.start_date),s=new Date(o.value.end_date),f=Math.abs(s-a);return Math.ceil(f/(1e3*60*60*24))+1}),k=a=>a?new Date(a).toLocaleDateString():"N/A",T=a=>a?new Date(a).toLocaleString():"N/A",V=a=>({pending:"badge bg-warning",approved:"badge bg-success",rejected:"badge bg-danger"})[a.status]||"badge bg-secondary",N=a=>({pending:"Pending",approved:"Approved",rejected:"Rejected"})[a.status]||a.status,G=a=>{const s=_.leaveRules.find(f=>f.leave_type===a);return s?s.display_name:a},H=a=>{i.value=a,p.value=!0},J=a=>{window.location.href=route("admin.leave.edit",a.id)},K=a=>{i.value=a,v.value={status:"approved",admin_notes:""},c.value=!0},Q=a=>{i.value=a,v.value={status:"rejected",admin_notes:""},c.value=!0},W=()=>{p.value=!1,v.value={status:"",admin_notes:""},c.value=!0},$=()=>{if(!v.value.status){alert("Please select a decision");return}oe.patch(route("admin.leave.approve",i.value.id),v.value,{onSuccess:()=>{c.value=!1,p.value=!1,window.location.reload()}})},X=()=>{o.value={user_id:"",leave_type:"",start_date:"",end_date:"",details:"",status:"pending",admin_notes:""},g.value=!0},Y=()=>{o.value.leave_type=""},Z=()=>{},M=()=>{if(console.log("Submitting form data:",o.value),!o.value.user_id){alert("Please select an employee");return}if(!o.value.leave_type){alert("Please select a leave type");return}if(!o.value.start_date){alert("Please select a start date");return}if(!o.value.end_date){alert("Please select an end date");return}if(!o.value.details){alert("Please provide request details");return}ae(o.value).post(route("admin.leave.store"),{onSuccess:()=>{console.log("Form submitted successfully"),g.value=!1,window.location.reload()},onError:a=>{console.error("Form errors:",a),alert("Please check the form and try again")}})};return ee(()=>{}),(a,s)=>(n(),se(ne,null,{default:te(()=>{var f,P,F,U;return[e("div",re,[e("div",ue,[e("div",ve,[e("div",me,[e("div",ce,[s[22]||(s[22]=e("div",{class:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px"}},[e("i",{class:"bx bxs-calendar-check"})],-1)),e("div",pe,[s[21]||(s[21]=e("h6",{class:"mb-0"},"Total Requests",-1)),e("h3",be,l(y.leaveRequests.total),1)])])])]),e("div",ye,[e("div",_e,[e("div",ge,[s[24]||(s[24]=e("div",{class:"bg-warning text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px"}},[e("i",{class:"bx bxs-time"})],-1)),e("div",fe,[s[23]||(s[23]=e("h6",{class:"mb-0"},"Pending",-1)),e("h3",xe,l(B.value),1)])])])]),e("div",we,[e("div",ke,[e("div",Ce,[s[26]||(s[26]=e("div",{class:"bg-success text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px"}},[e("i",{class:"bx bxs-check-circle"})],-1)),e("div",he,[s[25]||(s[25]=e("h6",{class:"mb-0"},"Approved",-1)),e("h3",Re,l(O.value),1)])])])]),e("div",Ae,[e("div",De,[e("div",Se,[s[28]||(s[28]=e("div",{class:"bg-danger text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px"}},[e("i",{class:"bx bxs-x-circle"})],-1)),e("div",je,[s[27]||(s[27]=e("h6",{class:"mb-0"},"Rejected",-1)),e("h3",qe,l(z.value),1)])])])]),e("div",Pe,[e("div",Le,[e("div",{class:"card-header bg-white"},[e("div",{class:"d-flex justify-content-between align-items-center"},[s[30]||(s[30]=e("h5",{class:"mb-0"},"All Leave Requests",-1)),e("button",{class:"btn btn-primary btn-sm",onClick:X},s[29]||(s[29]=[e("i",{class:"bx bx-plus me-1"},null,-1),r("Create Request ")]))])]),e("div",Te,[e("div",Ve,[e("table",Ne,[s[37]||(s[37]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{class:"border-0"},"Employee"),e("th",{class:"border-0"},"Leave Type"),e("th",{class:"border-0"},"Date Range"),e("th",{class:"border-0"},"Days"),e("th",{class:"border-0"},"Status"),e("th",{class:"border-0"},"Submitted"),e("th",{class:"border-0"},"Actions")])],-1)),e("tbody",null,[(n(!0),d(D,null,A(y.leaveRequests.data,t=>{var C,E;return n(),d("tr",{key:t.id},[e("td",null,[e("div",null,[e("strong",null,l(((C=t.user)==null?void 0:C.name)||"N/A"),1),e("div",$e,l(((E=t.user)==null?void 0:E.email)||"N/A"),1)])]),e("td",null,[e("span",Me,l(t.leave_type_display||t.leave_type),1)]),e("td",null,[e("div",Fe,[e("div",null,[s[31]||(s[31]=e("strong",null,"From:",-1)),r(" "+l(k(t.start_date)),1)]),e("div",null,[s[32]||(s[32]=e("strong",null,"To:",-1)),r(" "+l(k(t.end_date)),1)])])]),e("td",null,[e("span",Ue,l(t.days_requested)+" days",1)]),e("td",null,[e("span",{class:I(V(t))},l(N(t)),3)]),e("td",Ee,l(k(t.created_at)),1),e("td",null,[e("button",{class:"btn btn-sm btn-outline-primary me-1",onClick:L=>H(t)},s[33]||(s[33]=[e("i",{class:"bx bx-show"},null,-1)]),8,Ie),t.status==="pending"?(n(),d("button",{key:0,class:"btn btn-sm btn-outline-success me-1",onClick:L=>K(t)},s[34]||(s[34]=[e("i",{class:"bx bx-check"},null,-1)]),8,Be)):u("",!0),t.status==="pending"?(n(),d("button",{key:1,class:"btn btn-sm btn-outline-danger me-1",onClick:L=>Q(t)},s[35]||(s[35]=[e("i",{class:"bx bx-x"},null,-1)]),8,Oe)):u("",!0),t.status==="pending"?(n(),d("button",{key:2,class:"btn btn-sm btn-outline-warning",onClick:L=>J(t)},s[36]||(s[36]=[e("i",{class:"bx bx-edit"},null,-1)]),8,ze)):u("",!0)])])}),128))])])])]),e("div",Ge,[le(de,{paginate:y.leaveRequests},null,8,["paginate"])])])])])]),p.value?(n(),d("div",{key:0,class:"modal-overlay",onClick:s[3]||(s[3]=t=>p.value=!1)},[e("div",{class:"modal-container",onClick:s[2]||(s[2]=h(()=>{},["stop"]))},[e("div",He,[e("div",Je,[s[38]||(s[38]=e("h5",{class:"modal-title"},"Leave Request Details",-1)),e("button",{type:"button",class:"btn-close",onClick:s[0]||(s[0]=t=>p.value=!1)})]),i.value?(n(),d("div",Ke,[e("div",Qe,[e("div",We,[s[41]||(s[41]=e("h6",{class:"text-primary"},"Employee Information",-1)),e("p",null,[s[39]||(s[39]=e("strong",null,"Name:",-1)),r(" "+l((f=i.value.user)==null?void 0:f.name),1)]),e("p",null,[s[40]||(s[40]=e("strong",null,"Email:",-1)),r(" "+l((P=i.value.user)==null?void 0:P.email),1)])]),e("div",Xe,[s[47]||(s[47]=e("h6",{class:"text-primary"},"Leave Information",-1)),e("p",null,[s[42]||(s[42]=e("strong",null,"Type:",-1)),s[43]||(s[43]=r()),e("span",Ye,l(i.value.leave_type_display||i.value.leave_type),1)]),e("p",null,[s[44]||(s[44]=e("strong",null,"Days:",-1)),s[45]||(s[45]=r()),e("span",Ze,l(i.value.days_requested)+" days",1)]),e("p",null,[s[46]||(s[46]=e("strong",null,"Status:",-1)),e("span",{class:I(V(i.value))},l(N(i.value)),3)])])]),e("div",es,[e("div",ss,[s[50]||(s[50]=e("h6",{class:"text-primary"},"Date Range",-1)),e("p",null,[s[48]||(s[48]=e("strong",null,"From:",-1)),r(" "+l(k(i.value.start_date)),1)]),e("p",null,[s[49]||(s[49]=e("strong",null,"To:",-1)),r(" "+l(k(i.value.end_date)),1)])]),e("div",ts,[s[54]||(s[54]=e("h6",{class:"text-primary"},"Timeline",-1)),e("p",null,[s[51]||(s[51]=e("strong",null,"Submitted:",-1)),r(" "+l(T(i.value.created_at)),1)]),i.value.approved_at?(n(),d("p",ls,[s[52]||(s[52]=e("strong",null,"Processed:",-1)),r(" "+l(T(i.value.approved_at)),1)])):u("",!0),i.value.approved_by?(n(),d("p",os,[s[53]||(s[53]=e("strong",null,"By:",-1)),r(" "+l((F=i.value.approved_by)==null?void 0:F.name),1)])):u("",!0)])]),e("div",as,[e("div",ns,[s[55]||(s[55]=e("h6",{class:"text-primary"},"Request Details",-1)),e("div",ds,l(i.value.details),1)])]),i.value.admin_notes?(n(),d("div",is,[e("div",rs,[s[56]||(s[56]=e("h6",{class:"text-primary"},"Admin Notes",-1)),e("div",us,l(i.value.admin_notes),1)])])):u("",!0)])):u("",!0),e("div",vs,[e("button",{type:"button",class:"btn btn-secondary",onClick:s[1]||(s[1]=t=>p.value=!1)},"Close"),((U=i.value)==null?void 0:U.status)==="pending"?(n(),d("button",{key:0,onClick:W,type:"button",class:"btn btn-primary"},"Process Request")):u("",!0)])])])])):u("",!0),c.value?(n(),d("div",{key:1,class:"modal-overlay",onClick:s[9]||(s[9]=t=>c.value=!1)},[e("div",{class:"modal-container",onClick:s[8]||(s[8]=h(()=>{},["stop"]))},[e("div",ms,[e("div",cs,[s[57]||(s[57]=e("h5",{class:"modal-title"},"Process Leave Request",-1)),e("button",{type:"button",class:"btn-close",onClick:s[4]||(s[4]=t=>c.value=!1)})]),e("div",ps,[e("form",{onSubmit:h($,["prevent"])},[e("div",bs,[s[59]||(s[59]=e("label",{class:"form-label"},"Decision",-1)),m(e("select",{"onUpdate:modelValue":s[5]||(s[5]=t=>v.value.status=t),class:"form-control",required:""},s[58]||(s[58]=[e("option",{value:""},"Select decision",-1),e("option",{value:"approved"},"✅ Approve",-1),e("option",{value:"rejected"},"❌ Reject",-1)]),512),[[S,v.value.status]])]),e("div",ys,[s[60]||(s[60]=e("label",{class:"form-label"},"Notes (Optional)",-1)),m(e("textarea",{"onUpdate:modelValue":s[6]||(s[6]=t=>v.value.admin_notes=t),class:"form-control",rows:"3",placeholder:"Add any notes or comments..."},null,512),[[R,v.value.admin_notes]])])],32)]),e("div",_s,[e("button",{type:"button",class:"btn btn-secondary",onClick:s[7]||(s[7]=t=>c.value=!1)},"Cancel"),e("button",{onClick:$,type:"button",class:"btn btn-primary"},"Submit Decision")])])])])):u("",!0),g.value?(n(),d("div",{key:2,class:"modal-overlay",onClick:s[20]||(s[20]=t=>g.value=!1)},[e("div",{class:"modal-container modal-lg",onClick:s[19]||(s[19]=h(()=>{},["stop"]))},[e("div",gs,[e("div",fs,[s[61]||(s[61]=e("h5",{class:"modal-title"},"Create Leave Request",-1)),e("button",{type:"button",class:"btn-close",onClick:s[10]||(s[10]=t=>g.value=!1)})]),e("div",xs,[e("form",{onSubmit:h(M,["prevent"])},[e("div",ws,[e("div",ks,[e("div",Cs,[s[63]||(s[63]=e("label",{class:"form-label"},"Employee",-1)),m(e("select",{"onUpdate:modelValue":s[11]||(s[11]=t=>o.value.user_id=t),onChange:Y,class:"form-control",required:""},[s[62]||(s[62]=e("option",{value:""},"Select employee",-1)),(n(!0),d(D,null,A(y.employees,t=>(n(),d("option",{key:t.id,value:t.id},l(t.name)+" ("+l(t.email)+") ",9,hs))),128))],544),[[S,o.value.user_id]])])]),e("div",Rs,[e("div",As,[s[65]||(s[65]=e("label",{class:"form-label"},"Leave Type",-1)),m(e("select",{"onUpdate:modelValue":s[12]||(s[12]=t=>o.value.leave_type=t),onChange:Z,class:"form-control",required:""},[s[64]||(s[64]=e("option",{value:""},"Select leave type",-1)),(n(!0),d(D,null,A(y.leaveRules,t=>(n(),d("option",{key:t.leave_type,value:t.leave_type},[r(l(t.display_name)+" ",1),b.value&&b.value[t.leave_type]?(n(),d("span",Ss," ("+l(b.value[t.leave_type].available_credits)+" credits left) ",1)):u("",!0)],8,Ds))),128))],544),[[S,o.value.leave_type]])])])]),b.value?(n(),d("div",js,[s[67]||(s[67]=e("h6",{class:"text-info mb-2"},"Available Leave Credits",-1)),e("div",qs,[(n(!0),d(D,null,A(b.value,(t,C)=>(n(),d("div",{key:C,class:"col-md-4"},[e("div",Ps,[e("div",Ls,[e("div",Ts,l(G(C)),1),e("div",Vs,[e("span",Ns,"Available: "+l(t.available_credits),1),s[66]||(s[66]=r(" / ")),e("span",$s,"Total: "+l(t.total_credits),1)]),e("div",Ms," Used: "+l(t.used_credits),1)])])]))),128))])])):u("",!0),e("div",Fs,[e("div",Us,[e("div",Es,[s[68]||(s[68]=e("label",{class:"form-label"},"Start Date",-1)),m(e("input",{"onUpdate:modelValue":s[13]||(s[13]=t=>o.value.start_date=t),type:"date",class:"form-control",required:""},null,512),[[R,o.value.start_date]])])]),e("div",Is,[e("div",Bs,[s[69]||(s[69]=e("label",{class:"form-label"},"End Date",-1)),m(e("input",{"onUpdate:modelValue":s[14]||(s[14]=t=>o.value.end_date=t),type:"date",class:"form-control",required:""},null,512),[[R,o.value.end_date]])])])]),q.value>0?(n(),d("div",Os,[s[70]||(s[70]=e("label",{class:"form-label"},"Days Requested",-1)),e("div",zs,[e("span",Gs,l(q.value)+" days",1),j.value?(n(),d("span",Hs,[r(" Available credits: "+l(j.value.available_credits)+" ",1),q.value>j.value.available_credits?(n(),d("span",Js," ⚠️ Insufficient credits ")):u("",!0)])):u("",!0)])])):u("",!0),e("div",Ks,[s[71]||(s[71]=e("label",{class:"form-label"},"Request Details",-1)),m(e("textarea",{"onUpdate:modelValue":s[15]||(s[15]=t=>o.value.details=t),class:"form-control",rows:"3",placeholder:"Please provide detailed reason for the leave request...",required:""},null,512),[[R,o.value.details]])]),e("div",Qs,[e("div",Ws,[e("div",Xs,[s[73]||(s[73]=e("label",{class:"form-label"},"Status",-1)),m(e("select",{"onUpdate:modelValue":s[16]||(s[16]=t=>o.value.status=t),class:"form-control",required:""},s[72]||(s[72]=[e("option",{value:"pending"},"⏳ Pending",-1),e("option",{value:"approved"},"✅ Approved",-1),e("option",{value:"rejected"},"❌ Rejected",-1)]),512),[[S,o.value.status]])])]),e("div",Ys,[e("div",Zs,[s[74]||(s[74]=e("label",{class:"form-label"},"Admin Notes (Optional)",-1)),m(e("textarea",{"onUpdate:modelValue":s[17]||(s[17]=t=>o.value.admin_notes=t),class:"form-control",rows:"2",placeholder:"Add any admin notes..."},null,512),[[R,o.value.admin_notes]])])])])],32)]),e("div",et,[e("button",{type:"button",class:"btn btn-secondary",onClick:s[18]||(s[18]=t=>g.value=!1)},"Cancel"),e("button",{onClick:M,type:"button",class:"btn btn-primary"},s[75]||(s[75]=[e("i",{class:"bx bx-plus me-1"},null,-1),r("Create Request ")]))])])])])):u("",!0)]}),_:1}))}},nt=ie(st,[["__scopeId","data-v-28fd90b6"]]);export{nt as default};
