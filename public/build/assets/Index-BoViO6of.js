import{r,n as p,p as T,j as S,w as h,o as a,b as s,t as l,h as x,a as _,u as y,i as f,c as d,f as w,F as C,k as V,d as F,l as P,s as M,g as q,e as k}from"./app-DSbO2B8p.js";import{A as U}from"./AuthenticatedLayout-C2NJg4lw.js";import{P as $}from"./Pagination-DBAlykLF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"container-fluid p-2"},O={class:"row g-4"},G={class:"col-md-3"},H={class:"card p-3 shadow-sm border-0 bg-light"},J={class:"d-flex align-items-center"},K={class:"ms-3"},Q={class:"mb-0"},W={class:"col-md-3"},X={class:"card p-3 shadow-sm border-0 bg-light"},Y={class:"d-flex align-items-center"},Z={class:"ms-3"},ss={class:"mb-0"},ts={class:"col-md-3"},es={class:"card p-3 shadow-sm border-0 bg-light"},os={class:"d-flex align-items-center"},ls={class:"ms-3"},as={class:"mb-0"},ds={class:"col-md-3"},ns={class:"card p-3 shadow-sm border-0 bg-light"},is={class:"d-flex align-items-center"},cs={class:"ms-3"},rs={class:"mb-0"},us={class:"col-md-12"},ms={class:"card shadow-sm border-0"},bs={class:"card-header bg-white"},vs={class:"d-flex justify-content-between align-items-center"},ps={class:"card-body p-0"},hs={class:"table-responsive"},_s={class:"table table-hover mb-0"},gs={class:"badge bg-info"},xs=["onClick"],ys=["onClick"],fs={class:"card-footer bg-white"},ws={class:"modal fade",id:"creditsModal",tabindex:"-1",ref:"creditsModal"},Cs={class:"modal-dialog"},Ms={class:"modal-content"},ks={class:"modal-body"},Rs={key:0,class:"row"},js={class:"card"},As={class:"card-body"},Bs={class:"card-title"},Ls={class:"row"},Ds={class:"col-md-4"},Es={class:"mb-0"},Ns={class:"col-md-4"},Is={class:"mb-0"},Ts={class:"text-warning"},Ss={class:"col-md-4"},Vs={class:"mb-0"},Fs={class:"text-success"},Ps={key:1,class:"text-center"},qs={class:"modal fade",id:"approveModal",tabindex:"-1",ref:"approveModal"},Us={class:"modal-dialog"},$s={class:"modal-content"},zs={class:"modal-header"},Os={class:"modal-title"},Gs={class:"modal-body"},Hs={class:"mb-3"},Js={class:"d-flex justify-content-end gap-2"},Ys={__name:"Index",props:{leaveRequests:Object,isAdmin:Boolean},setup(n){const b=n;r(!1);const v=r(null),i=r("approve"),u=r(""),c=r(null),R=p(()=>b.leaveRequests.data.filter(o=>o.status==="pending").length),j=p(()=>b.leaveRequests.data.filter(o=>o.status==="approved").length),A=p(()=>b.leaveRequests.data.filter(o=>o.status==="rejected").length),B=o=>{i.value="approve",c.value=o,new bootstrap.Modal(document.getElementById("approveModal")).show()},L=o=>{i.value="reject",c.value=o,new bootstrap.Modal(document.getElementById("approveModal")).show()},D=()=>{c.value&&q.patch(route("leave.approve",c.value.id),{status:i.value,admin_notes:u.value},{onSuccess:()=>{bootstrap.Modal.getInstance(document.getElementById("approveModal")).hide(),u.value="",c.value=null}})},E=async()=>{try{const o=await fetch(route("leave.my-credits"));v.value=await o.json()}catch(o){console.error("Error loading credits:",o)}},N=()=>{E(),new bootstrap.Modal(document.getElementById("creditsModal")).show()};T(()=>{});const g=o=>new Date(o).toLocaleDateString();return(o,t)=>(a(),S(U,null,{default:h(()=>[s("div",z,[s("div",O,[s("div",G,[s("div",H,[s("div",J,[t[2]||(t[2]=s("div",{class:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px"}},[s("i",{class:"bx bxs-calendar"})],-1)),s("div",K,[t[1]||(t[1]=s("h6",{class:"mb-0"},"Total Requests",-1)),s("h3",Q,l(n.leaveRequests.total),1)])])])]),s("div",W,[s("div",X,[s("div",Y,[t[4]||(t[4]=s("div",{class:"bg-warning text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px"}},[s("i",{class:"bx bxs-time"})],-1)),s("div",Z,[t[3]||(t[3]=s("h6",{class:"mb-0"},"Pending",-1)),s("h3",ss,l(R.value),1)])])])]),s("div",ts,[s("div",es,[s("div",os,[t[6]||(t[6]=s("div",{class:"bg-success text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px"}},[s("i",{class:"bx bxs-check-circle"})],-1)),s("div",ls,[t[5]||(t[5]=s("h6",{class:"mb-0"},"Approved",-1)),s("h3",as,l(j.value),1)])])])]),s("div",ds,[s("div",ns,[s("div",is,[t[8]||(t[8]=s("div",{class:"bg-danger text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px"}},[s("i",{class:"bx bxs-x-circle"})],-1)),s("div",cs,[t[7]||(t[7]=s("h6",{class:"mb-0"},"Rejected",-1)),s("h3",rs,l(A.value),1)])])])]),s("div",us,[s("div",ms,[s("div",bs,[s("div",vs,[t[11]||(t[11]=s("h5",{class:"mb-0"},"Leave Requests",-1)),s("div",null,[s("button",{class:"btn btn-info btn-sm me-2",onClick:N},t[9]||(t[9]=[s("i",{class:"bx bx-info-circle me-1"},null,-1),x("My Credits ")])),_(y(f),{href:o.route("leave.create"),class:"btn btn-primary btn-sm"},{default:h(()=>t[10]||(t[10]=[s("i",{class:"bx bx-plus me-1"},null,-1),x("Request Leave ")])),_:1},8,["href"])])])]),s("div",ps,[s("div",hs,[s("table",_s,[t[15]||(t[15]=s("thead",{class:"table-light"},[s("tr",null,[s("th",{class:"border-0"},"Employee"),s("th",{class:"border-0"},"Leave Type"),s("th",{class:"border-0"},"Date Range"),s("th",{class:"border-0"},"Days"),s("th",{class:"border-0"},"Status"),s("th",{class:"border-0"},"Actions")])],-1)),s("tbody",null,[(a(!0),d(C,null,w(n.leaveRequests.data,e=>{var m;return a(),d("tr",{key:e.id},[s("td",null,l(((m=e.user)==null?void 0:m.name)||"N/A"),1),s("td",null,[s("span",gs,l(e.leave_type_display||e.leave_type),1)]),s("td",null,l(g(e.start_date))+" - "+l(g(e.end_date)),1),s("td",null,l(e.days_requested)+" days",1),s("td",null,[s("span",{class:M(e.status_badge_class)},l(e.status_display),3)]),s("td",null,[_(y(f),{href:o.route("leave.show",e.id),class:"btn btn-sm btn-outline-primary me-1"},{default:h(()=>t[12]||(t[12]=[s("i",{class:"bx bx-show"},null,-1)])),_:2},1032,["href"]),n.isAdmin&&e.status==="pending"?(a(),d("button",{key:0,class:"btn btn-sm btn-outline-success me-1",onClick:I=>B(e)},t[13]||(t[13]=[s("i",{class:"bx bx-check"},null,-1)]),8,xs)):k("",!0),n.isAdmin&&e.status==="pending"?(a(),d("button",{key:1,class:"btn btn-sm btn-outline-danger",onClick:I=>L(e)},t[14]||(t[14]=[s("i",{class:"bx bx-x"},null,-1)]),8,ys)):k("",!0)])])}),128))])])])]),s("div",fs,[_($,{paginate:n.leaveRequests},null,8,["paginate"])])])])])]),s("div",ws,[s("div",Cs,[s("div",Ms,[t[20]||(t[20]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title"},"My Leave Credits"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),s("div",ks,[v.value?(a(),d("div",Rs,[(a(!0),d(C,null,w(v.value,(e,m)=>(a(),d("div",{key:m,class:"col-md-12 mb-3"},[s("div",js,[s("div",As,[s("h6",Bs,l(e.display_name),1),s("div",Ls,[s("div",Ds,[t[16]||(t[16]=s("small",{class:"text-muted"},"Total Credits",-1)),s("p",Es,[s("strong",null,l(e.total_credits),1)])]),s("div",Ns,[t[17]||(t[17]=s("small",{class:"text-muted"},"Used Credits",-1)),s("p",Is,[s("strong",Ts,l(e.used_credits),1)])]),s("div",Ss,[t[18]||(t[18]=s("small",{class:"text-muted"},"Available",-1)),s("p",Vs,[s("strong",Fs,l(e.available_credits),1)])])])])])]))),128))])):(a(),d("div",Ps,t[19]||(t[19]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])))]),t[21]||(t[21]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512),s("div",qs,[s("div",Us,[s("div",$s,[s("div",zs,[s("h5",Os,l(i.value==="approve"?"Approve":"Reject")+" Leave Request",1),t[22]||(t[22]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1))]),s("div",Gs,[s("form",{onSubmit:V(D,["prevent"])},[s("div",Hs,[t[23]||(t[23]=s("label",{class:"form-label"},"Admin Notes",-1)),F(s("textarea",{class:"form-control","onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),rows:"3",placeholder:"Add notes (optional)"},null,512),[[P,u.value]])]),s("div",Js,[t[24]||(t[24]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"submit",class:M(i.value==="approve"?"btn btn-success":"btn btn-danger")},l(i.value==="approve"?"Approve":"Reject"),3)])],32)])])])],512)]),_:1}))}};export{Ys as default};
