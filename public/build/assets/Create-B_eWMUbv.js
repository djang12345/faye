import{T as w,r as k,n as y,A as q,j as D,w as x,o as d,b as e,k as C,d as c,x as R,u as r,c as i,f as V,F as S,t as n,e as u,l as b,h as _,a as L,i as T}from"./app-DSbO2B8p.js";import{A}from"./AuthenticatedLayout-C2NJg4lw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"container-fluid p-2"},M={class:"row justify-content-center"},U={class:"col-md-8"},B={class:"card shadow-sm border-0"},E={class:"card-body"},N={class:"row"},F={class:"col-md-6"},I={class:"mb-3"},O=["value"],P={key:0,class:"text-danger small"},Y={class:"mb-3"},z={key:0,class:"text-danger small"},G={class:"mb-3"},H={key:0,class:"text-danger small"},J={class:"mb-3"},K={class:"col-md-6"},Q={class:"mb-3"},W={key:0,class:"text-danger small"},X={key:0,class:"card bg-light"},Z={class:"card-body"},$={class:"row"},ee={class:"col-md-4"},te={class:"mb-0"},se={class:"col-md-4"},ae={class:"mb-0"},le={class:"text-success"},oe={class:"col-md-4"},de={class:"mb-0"},re={class:"text-info"},ie={key:0,class:"alert alert-warning mt-2 mb-0"},ne={class:"d-flex justify-content-end gap-2"},ue=["disabled"],ve={key:0,class:"spinner-border spinner-border-sm me-1"},ye={__name:"Create",props:{leaveRules:Array,availableCredits:Object,errors:Object},setup(l){const p=l,s=w({leave_type:"",start_date:"",end_date:"",details:""}),v=k(!1),g=y(()=>p.leaveRules.find(o=>o.leave_type===s.leave_type)),m=y(()=>{if(!s.start_date||!s.end_date)return 0;const o=new Date(s.start_date),t=new Date(s.end_date),a=Math.abs(t-o);return Math.ceil(a/(1e3*60*60*24))+1}),f=y(()=>s.leave_type?(p.availableCredits[s.leave_type]||0)>=m.value:!1);q([()=>s.start_date,()=>s.end_date],([o,t])=>{o&&t&&new Date(o)>new Date(t)&&(s.end_date=o)});const h=()=>{if(!f.value){alert("You do not have enough credits for this request.");return}v.value=!0,s.post(route("leave.store"),{onSuccess:()=>{v.value=!1},onError:()=>{v.value=!1}})};return(o,t)=>(d(),D(A,null,{default:x(()=>[e("div",j,[e("div",M,[e("div",U,[e("div",B,[t[19]||(t[19]=e("div",{class:"card-header bg-white"},[e("h5",{class:"mb-0"},"Request Leave")],-1)),e("div",E,[e("form",{onSubmit:C(h,["prevent"])},[e("div",N,[e("div",F,[e("div",I,[t[6]||(t[6]=e("label",{class:"form-label"},"Leave Type *",-1)),c(e("select",{class:"form-control","onUpdate:modelValue":t[0]||(t[0]=a=>r(s).leave_type=a),required:""},[t[5]||(t[5]=e("option",{value:""},"Select Leave Type",-1)),(d(!0),i(S,null,V(l.leaveRules,a=>(d(),i("option",{key:a.id,value:a.leave_type},n(a.display_name)+" ("+n(l.availableCredits[a.leave_type]||0)+" credits available) ",9,O))),128))],512),[[R,r(s).leave_type]]),l.errors.leave_type?(d(),i("div",P,n(l.errors.leave_type),1)):u("",!0)]),e("div",Y,[t[7]||(t[7]=e("label",{class:"form-label"},"Start Date *",-1)),c(e("input",{type:"date",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=a=>r(s).start_date=a),required:""},null,512),[[b,r(s).start_date]]),l.errors.start_date?(d(),i("div",z,n(l.errors.start_date),1)):u("",!0)]),e("div",G,[t[8]||(t[8]=e("label",{class:"form-label"},"End Date *",-1)),c(e("input",{type:"date",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=a=>r(s).end_date=a),required:""},null,512),[[b,r(s).end_date]]),l.errors.end_date?(d(),i("div",H,n(l.errors.end_date),1)):u("",!0)]),e("div",J,[t[9]||(t[9]=e("label",{class:"form-label"},"Days Requested",-1)),c(e("input",{type:"number",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=a=>m.value=a),readonly:""},null,512),[[b,m.value]]),t[10]||(t[10]=e("small",{class:"text-muted"},"Automatically calculated based on date range",-1))])]),e("div",K,[e("div",Q,[t[11]||(t[11]=e("label",{class:"form-label"},"Leave Details *",-1)),c(e("textarea",{class:"form-control","onUpdate:modelValue":t[4]||(t[4]=a=>r(s).details=a),rows:"8",placeholder:"Please provide detailed information about your leave request...",required:""},null,512),[[b,r(s).details]]),l.errors.details?(d(),i("div",W,n(l.errors.details),1)):u("",!0)]),g.value?(d(),i("div",X,[e("div",Z,[t[16]||(t[16]=e("h6",{class:"card-title"},"Credit Information",-1)),e("div",$,[e("div",ee,[t[12]||(t[12]=e("small",{class:"text-muted"},"Total Credits",-1)),e("p",te,[e("strong",null,n(g.value.default_credits),1)])]),e("div",se,[t[13]||(t[13]=e("small",{class:"text-muted"},"Available",-1)),e("p",ae,[e("strong",le,n(l.availableCredits[r(s).leave_type]||0),1)])]),e("div",oe,[t[14]||(t[14]=e("small",{class:"text-muted"},"Requesting",-1)),e("p",de,[e("strong",re,n(m.value),1)])])]),f.value?u("",!0):(d(),i("div",ie,t[15]||(t[15]=[e("i",{class:"bx bx-warning me-1"},null,-1),_(" Insufficient credits for this request. ")])))])])):u("",!0)])]),e("div",ne,[L(r(T),{href:o.route("leave.index"),class:"btn btn-secondary"},{default:x(()=>t[17]||(t[17]=[_(" Cancel ")])),_:1},8,["href"]),e("button",{type:"submit",class:"btn btn-primary",disabled:!f.value||v.value},[v.value?(d(),i("span",ve)):u("",!0),t[18]||(t[18]=_(" Submit Request "))],8,ue)])],32)])])])])])]),_:1}))}};export{ye as default};
