import{T as q,c,a as m,u as l,w as R,F as b,o as u,Z as G,e as f,b as e,h,t as a,f as g,k as H,d as p,l as O,x as v,s as J,i as Q,g as $}from"./app-DSbO2B8p.js";import{A as W}from"./AuthenticatedLayout-C2NJg4lw.js";import{_ as Y}from"./PasswordInput-Brhux05U.js";import{a as X}from"./functions-DzHC9xVL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"container p-4"},te={class:"row mb-4"},se={class:"col-md-3"},le={class:"card bg-primary text-white"},oe={class:"card-body"},ae={class:"col-md-3"},ne={class:"card bg-success text-white"},ie={class:"card-body"},re={class:"col-md-3"},de={class:"card bg-danger text-white"},ce={class:"card-body"},ue={class:"col-md-3"},me={class:"card bg-info text-white"},pe={class:"card-body"},be={class:"card"},fe={class:"card-body p-0"},we={class:"table-responsive"},he={class:"table table-hover mb-0"},ge={key:0,class:"text-center"},ve={class:"btn-group",role:"group"},ye=["onClick"],Ce=["onClick"],xe={key:1,class:"card mt-4"},Ae={class:"card-body p-0"},Se={class:"table-responsive"},_e={class:"table table-hover mb-0"},Be=["onClick"],Ue={class:"modal fade",id:"addUserModal",tabindex:"-1","aria-labelledby":"addUserModalLabel","aria-hidden":"true"},Ee={class:"modal-dialog modal-lg"},Te={class:"modal-content"},ke={class:"modal-body"},Ne={class:"row mb-3"},Fe={class:"col-sm-10"},De={class:"row mb-3"},Pe={class:"col-sm-10"},Ve={class:"row mb-3"},Le={class:"col-sm-10"},Me={class:"row mb-3"},qe={class:"col-sm-10"},Re={class:"row mb-3"},Oe={class:"col-sm-10"},$e={class:"modal fade",id:"createFromApplicantModal",tabindex:"-1","aria-labelledby":"createFromApplicantModalLabel","aria-hidden":"true"},Ye={class:"modal-dialog"},je={class:"modal-content"},Ie={class:"modal-body"},Ke={class:"mb-3"},ze=["value"],Ze={class:"mb-3"},Xe={__name:"Index",props:{users:{type:Object,required:!0},acceptedApplicants:{type:Array,required:!0},auth:{type:Object,required:!0}},setup(i){var x,A,S,_;const r=i;console.log("User Index props:",r),console.log("Users data:",r.users),console.log("Users data type:",typeof r.users),console.log("Users data keys:",Object.keys(r.users||{})),console.log("Users.data:",(x=r.users)==null?void 0:x.data),console.log("Users.data length:",(S=(A=r.users)==null?void 0:A.data)==null?void 0:S.length),console.log("Accepted applicants:",r.acceptedApplicants),console.log("Accepted applicants length:",(_=r.acceptedApplicants)==null?void 0:_.length);const j=r.auth.user.name,n=q({name:"",email:"",password:"",password_confirmation:"",role:"employee"}),d=q({applicant_id:"",role:"employee"}),y=()=>{if(n.password!==n.password_confirmation){Swal.fire({icon:"error",title:"Passwords Do Not Match",text:"Please ensure both password fields match.",confirmButtonText:"OK",confirmButtonColor:"#d33"});return}Swal.fire({title:"Are you sure?",text:"You are about to register this user!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, register!",cancelButtonText:"Cancel"}).then(o=>{o.isConfirmed&&(Swal.fire({title:"Registering...",text:"Please wait while we register the user.",didOpen:()=>{Swal.showLoading()}}),n.post(route("user.store"),{onSuccess:()=>{Swal.fire({icon:"success",title:"User Registered",text:"The user has been successfully registered!",timer:2e3,showConfirmButton:!1}),n.reset("password","password_confirmation")},onError:()=>{Swal.fire({icon:"error",title:"Failed",text:"There was a problem registering the user. Please try again."})}}))})},C=()=>{if(console.log("createFromApplicant called"),console.log("Form data:",d.data()),!d.applicant_id){Swal.fire({icon:"error",title:"No Applicant Selected",text:"Please select an applicant to create an employee account.",confirmButtonText:"OK",confirmButtonColor:"#d33"});return}const o=r.acceptedApplicants.find(w=>w.applicant.id==d.applicant_id),t=o?`${o.applicant.firstname} ${o.applicant.lastname}`:"the applicant";Swal.fire({title:"Create Employee Account?",text:`This will create an employee account for ${t} using their email and send credentials.`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, create account!",cancelButtonText:"Cancel"}).then(w=>{w.isConfirmed&&(console.log("User confirmed, submitting form..."),Swal.fire({title:"Creating Account...",text:"Please wait while we create the employee account.",didOpen:()=>{Swal.showLoading()}}),d.post(route("user.create-from-applicant"),{onSuccess:()=>{console.log("Success: Account created"),Swal.fire({icon:"success",title:"Account Created",text:"Employee account created successfully! Credentials have been sent.",timer:3e3,showConfirmButton:!1}),d.reset()},onError:B=>{console.log("Error:",B),Swal.fire({icon:"error",title:"Failed",text:B.email||"There was a problem creating the account."})}}))})},I=o=>{Swal.fire({title:"Resend Credentials?",text:`This will send new login credentials to ${o.email}`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, send credentials!",cancelButtonText:"Cancel"}).then(t=>{t.isConfirmed&&(Swal.fire({title:"Sending Credentials...",text:"Please wait while we send the credentials.",didOpen:()=>{Swal.showLoading()}}),$.post(route("user.resend-credentials",o.id),{},{onSuccess:()=>{Swal.fire({icon:"success",title:"Credentials Sent",text:"New credentials have been sent to the user's email.",timer:2e3,showConfirmButton:!1})},onError:()=>{Swal.fire({icon:"error",title:"Failed",text:"There was a problem sending the credentials."})}}))})},K=o=>{Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(t=>{t.isConfirmed&&(Swal.fire({title:"Deleting...",text:"Please wait while we delete the registered user data.",didOpen:()=>{Swal.showLoading()}}),$.delete(route("user.destroy",o),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{Swal.fire({icon:"success",title:"Deleted!",text:"The user has been deleted.",timer:2e3,showConfirmButton:!1})},onError:()=>{Swal.fire("Error!","Failed to delete the registered user.","error")}}))})},z=o=>o==="admin"?"badge bg-danger":"badge bg-success",Z=o=>o==="admin"?"Admin":"Employee";return(o,t)=>(u(),c(b,null,[m(l(G),{title:"Users"}),m(W,null,{default:R(()=>{var U,E,T,k,N,F,D,P,V,L;return[f("",!0),e("div",ee,[t[17]||(t[17]=e("div",{class:"d-flex justify-content-between align-items-center mb-3"},[e("h2",null,"User Management"),e("div",{class:"d-flex gap-2"},[e("button",{type:"button",class:"btn btn-success","data-bs-toggle":"modal","data-bs-target":"#createFromApplicantModal"},[e("i",{class:"bx bx-user-plus me-1"}),h("Create from Applicant ")]),e("button",{type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#addUserModal"},[e("i",{class:"bx bx-plus me-1"}),h("Add User ")])])],-1)),e("div",te,[e("div",se,[e("div",le,[e("div",oe,[t[7]||(t[7]=e("h5",{class:"card-title"},"Total Users",-1)),e("h3",null,a(((U=i.users)==null?void 0:U.total)||0),1)])])]),e("div",ae,[e("div",ne,[e("div",ie,[t[8]||(t[8]=e("h5",{class:"card-title"},"Employees",-1)),e("h3",null,a(((T=(E=i.users)==null?void 0:E.data)==null?void 0:T.filter(s=>s.role==="employee").length)||0),1)])])]),e("div",re,[e("div",de,[e("div",ce,[t[9]||(t[9]=e("h5",{class:"card-title"},"Admins",-1)),e("h3",null,a(((N=(k=i.users)==null?void 0:k.data)==null?void 0:N.filter(s=>s.role==="admin").length)||0),1)])])]),e("div",ue,[e("div",me,[e("div",pe,[t[10]||(t[10]=e("h5",{class:"card-title"},"Active Users",-1)),e("h3",null,a(((D=(F=i.users)==null?void 0:F.data)==null?void 0:D.length)||0),1)])])])]),e("div",be,[t[16]||(t[16]=e("div",{class:"card-header"},[e("h5",{class:"mb-0"},"User List")],-1)),e("div",fe,[e("div",we,[e("table",he,[t[15]||(t[15]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Name"),e("th",null,"Email"),e("th",null,"Role"),e("th",null,"Created"),e("th",null,"Actions")])],-1)),e("tbody",null,[(V=(P=i.users)==null?void 0:P.data)!=null&&V.length?f("",!0):(u(),c("tr",ge,t[11]||(t[11]=[e("td",{colspan:"5"},"No users found",-1)]))),(u(!0),c(b,null,g(((L=i.users)==null?void 0:L.data)||[],s=>(u(),c("tr",{key:s.id},[e("td",null,a(s.name),1),e("td",null,a(s.email),1),e("td",null,[e("span",{class:J(z(s.role))},a(Z(s.role)),3)]),e("td",null,a(new Date(s.created_at).toLocaleDateString()),1),e("td",null,[e("div",ve,[m(l(Q),{href:o.route("user.edit",s.id),class:"btn btn-sm btn-outline-primary",title:"Edit User"},{default:R(()=>t[12]||(t[12]=[e("i",{class:"bx bx-edit"},null,-1)])),_:2},1032,["href"]),e("button",{onClick:M=>I(s),class:"btn btn-sm btn-outline-warning",title:"Resend Credentials"},t[13]||(t[13]=[e("i",{class:"bx bx-envelope"},null,-1)]),8,ye),s.name!==l(j)?(u(),c("button",{key:0,onClick:M=>K(s.id),class:"btn btn-sm btn-outline-danger",title:"Delete User"},t[14]||(t[14]=[e("i",{class:"bx bx-trash"},null,-1)]),8,Ce)):f("",!0)])])]))),128))])])])])])]),i.acceptedApplicants.length>0?(u(),c("div",xe,[t[20]||(t[20]=e("div",{class:"card-header"},[e("h5",{class:"mb-0"},"Accepted Applicants (Ready for Employee Account Creation)")],-1)),e("div",Ae,[e("div",Se,[e("table",_e,[t[19]||(t[19]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Name"),e("th",null,"Email"),e("th",null,"Interview Date"),e("th",null,"Interview Time"),e("th",null,"Actions")])],-1)),e("tbody",null,[(u(!0),c(b,null,g(i.acceptedApplicants,s=>(u(),c("tr",{key:s.id},[e("td",null,a(s.applicant.firstname)+" "+a(s.applicant.lastname),1),e("td",null,a(s.applicant.email),1),e("td",null,a(new Date(s.interview_date).toLocaleDateString()),1),e("td",null,a(s.interview_time?l(X)(s.interview_time):"Not scheduled"),1),e("td",null,[e("button",{onClick:M=>{l(d).applicant_id=s.applicant.id,C()},class:"btn btn-sm btn-success",title:"Create Employee Account"},t[18]||(t[18]=[e("i",{class:"bx bx-user-plus"},null,-1),h(" Create Account ")]),8,Be)])]))),128))])])])])])):f("",!0),e("div",Ue,[e("div",Ee,[e("div",Te,[t[28]||(t[28]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"addUserModalLabel"},"Add New User"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",ke,[e("form",{onSubmit:H(y,["prevent"])},[e("div",Ne,[t[21]||(t[21]=e("label",{for:"inputName",class:"col-sm-2 col-form-label"},"Name",-1)),e("div",Fe,[p(e("input",{type:"text",class:"form-control",id:"inputName",placeholder:"Full Name","onUpdate:modelValue":t[0]||(t[0]=s=>l(n).name=s),required:""},null,512),[[O,l(n).name]])])]),e("div",De,[t[22]||(t[22]=e("label",{for:"inputEmail",class:"col-sm-2 col-form-label"},"Email",-1)),e("div",Pe,[p(e("input",{type:"email",class:"form-control",id:"inputEmail",placeholder:"Email Address","onUpdate:modelValue":t[1]||(t[1]=s=>l(n).email=s),required:""},null,512),[[O,l(n).email]])])]),e("div",Ve,[t[24]||(t[24]=e("label",{for:"inputRole",class:"col-sm-2 col-form-label"},"Role",-1)),e("div",Le,[p(e("select",{class:"form-control",id:"inputRole","onUpdate:modelValue":t[2]||(t[2]=s=>l(n).role=s),required:""},t[23]||(t[23]=[e("option",{value:"employee"},"Employee",-1),e("option",{value:"admin"},"Admin",-1)]),512),[[v,l(n).role]])])]),e("div",Me,[t[25]||(t[25]=e("label",{for:"inputPassword",class:"col-sm-2 col-form-label"},"Password",-1)),e("div",qe,[m(Y,{type:"password",class:"form-control",id:"inputPassword",placeholder:"Password",modelValue:l(n).password,"onUpdate:modelValue":t[3]||(t[3]=s=>l(n).password=s),required:""},null,8,["modelValue"])])]),e("div",Re,[t[26]||(t[26]=e("label",{for:"inputConfirmPassword",class:"col-sm-2 col-form-label"},"Confirm Password",-1)),e("div",Oe,[m(Y,{type:"password",class:"form-control",id:"inputConfirmPassword",placeholder:"Confirm Password",modelValue:l(n).password_confirmation,"onUpdate:modelValue":t[4]||(t[4]=s=>l(n).password_confirmation=s),required:""},null,8,["modelValue"])])])],32)]),e("div",{class:"modal-footer"},[t[27]||(t[27]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1)),e("button",{type:"button",class:"btn btn-primary",onClick:y},"Create User")])])])]),e("div",$e,[e("div",Ye,[e("div",je,[t[35]||(t[35]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"createFromApplicantModalLabel"},"Create Employee from Accepted Applicant"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",Ie,[e("div",Ke,[t[30]||(t[30]=e("label",{for:"applicantSelect",class:"form-label"},"Select Accepted Applicant",-1)),p(e("select",{class:"form-control",id:"applicantSelect","onUpdate:modelValue":t[5]||(t[5]=s=>l(d).applicant_id=s),required:""},[t[29]||(t[29]=e("option",{value:""},"Choose an accepted applicant...",-1)),(u(!0),c(b,null,g(i.acceptedApplicants,s=>(u(),c("option",{key:s.id,value:s.applicant.id},a(s.applicant.firstname)+" "+a(s.applicant.lastname)+" ("+a(s.applicant.email)+") ",9,ze))),128))],512),[[v,l(d).applicant_id]]),t[31]||(t[31]=e("small",{class:"form-text text-muted"},"Select an accepted applicant to create an employee account using their email.",-1))]),e("div",Ze,[t[33]||(t[33]=e("label",{for:"roleSelect",class:"form-label"},"Role",-1)),p(e("select",{class:"form-control",id:"roleSelect","onUpdate:modelValue":t[6]||(t[6]=s=>l(d).role=s),required:""},t[32]||(t[32]=[e("option",{value:"employee"},"Employee",-1),e("option",{value:"admin"},"Admin",-1)]),512),[[v,l(d).role]])])]),e("div",{class:"modal-footer"},[t[34]||(t[34]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1)),e("button",{type:"button",class:"btn btn-success",onClick:C},"Create Employee")])])])])]}),_:1})],64))}};export{Xe as default};
